<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Assortative dispersal stabilises priority effects and promote regional coexistence</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="Assortative-Dispersal-MS_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assortative-Dispersal-MS_files/libs/quarto-html/quarto.js"></script>
<script src="Assortative-Dispersal-MS_files/libs/quarto-html/popper.min.js"></script>
<script src="Assortative-Dispersal-MS_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assortative-Dispersal-MS_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assortative-Dispersal-MS_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assortative-Dispersal-MS_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assortative-Dispersal-MS_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assortative-Dispersal-MS_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assortative-Dispersal-MS_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assortative dispersal stabilises priority effects and promote regional coexistence</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="research-highlights" class="level2">
<h2 class="anchored" data-anchor-id="research-highlights">Research highlights</h2>
<ul>
<li><p>Using <em>in-silico</em> experiments, we discover a continuum of spatial coexistence mechanisms that vary from “staying together” to “coming together”</p></li>
<li><p>While staying together mechanisms have been studied extensively in the literature, our extension into the “coming together” realm provide plausible explanations for counterintuitive dispersal-diversity relationships found in the empirical systems</p></li>
<li><p>While all contribute to diversity-maintenance, the efficacy of these mechanisms are constrained by the uncertainty of environmental conditions (i.e.&nbsp;disturbance events) and the intrinsic costs of information processing when dispersal is informed. These constraints may serve to generate hypotheses regarding when and where certain coexistence mechanism are likely to be found or evolve.</p></li>
<li><p>Results are discussed in context of competition theory, metacommunity theory, and their connection. Results are also linked to the evolution of sociality, which we hope will encourage cross-pollination between these disparate fields</p></li>
</ul>
</section>
<section id="general-model" class="level2">
<h2 class="anchored" data-anchor-id="general-model">General model</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lifecycle.png" class="img-fluid figure-img" width="200"></p>
</figure>
</div>
</div>
</div>
<p><strong>Local population growth</strong></p>
<p><span class="math display">\[
n'_{ix} = \frac{\lambda n_{ix}}{1 + \sum\frac{\alpha_{ij}}{K(\lambda -1)}n_{ix}}
\]</span></p>
<p><strong>Emigration</strong></p>
<ul>
<li>a fraction <em>d</em> of individuals leave the patch</li>
</ul>
<p><span class="math display">\[
n''_{ix} = n'_{ix}(1 - d)
\]</span></p>
<p><strong>Immigration and Viability</strong></p>
<ul>
<li><p>Individuals from the 4 nearest neighbor patches y immigrate into patch x</p></li>
<li><p>Immigrants undergo viability selection in which only a fraction 1-C of individuals successfully immigrate</p></li>
<li><p>The proportion of emigrants that neighboring patches y immigrate into patch x depends on the weight <span class="math inline">\(\omega_{xy}\)</span> which is conditioned on the states of their neighboring patches z</p></li>
</ul>
<p><span class="math display">\[
n'''_{ix} = n''_{ix} + \sum_{y \neq x}^{4}n''_{ixy}(1 - C)\omega_{xy}
\]</span></p>
<p><strong>Weighting functions (i.e.&nbsp;dispersal rules)</strong>:</p>
<p>Density-informed</p>
<p><span class="math display">\[
\omega_{xy}^{N} = \frac{(n_{ix} + 1)^\delta}{\sum_{x}^{4}(n_{ix} + 1)^\delta}
\]</span></p>
<p>Fitness-informed</p>
<p><span class="math display">\[
\omega_{xy}^{W} = \frac{W_{iz}^\delta} {\sum_{x}^{4} W_{iz}^\delta}
\]</span></p>
<p><span class="math display">\[
W_{ix} = \frac{\lambda_i}{1 + \sum \alpha_{ij} n_{jx}(K(\lambda_i -1))^{-1}}
\]</span></p>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<ol type="1">
<li><strong>Coexistence time</strong> ~ <span class="math inline">\(\alpha_{ij}\)</span> + <span class="math inline">\(d\)</span> + <span class="math inline">\(\delta\)</span> + rule + <span class="math inline">\(c\)</span> + <span class="math inline">\(p\)</span>
<ul>
<li><p>Simulated on a 10x10 lattice</p></li>
<li><p>Max time: 5000</p></li>
<li><p>Coexistence time: time until one species goes extinct or until max time (5000) is reached</p></li>
</ul></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 32%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Interspecific competition (aij)</td>
<td style="text-align: left;">per capita effects of species j on i</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dispersal rate (d)</td>
<td style="text-align: left;">proportion of emigrants leaving a patch</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Assortativity (delta)</td>
<td style="text-align: left;">degree of dispersal assortavitiy</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dispersal rule</td>
<td style="text-align: left;">whether dispersal is weighted by densities or fitness</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cost of assortivity (c)</td>
<td style="text-align: left;">the decrease in viability as a result of dispersing assortatively</td>
</tr>
</tbody>
</table>
</div>
</div>
<ol start="2" type="1">
<li><strong>Spatial structure</strong></li>
</ol>
<ul>
<li><p>Reduce parameter space to a single dimension (<span class="math inline">\(s\)</span>) such that <span class="math inline">\(s\)</span> = <span class="math inline">\(d\)</span> = <span class="math inline">\(\delta\)</span> with <span class="math inline">\(\alpha_{ij} = 1.5\)</span> , <span class="math inline">\(c = 0.25\)</span> , and <span class="math inline">\(p = 0.05\)</span></p></li>
<li><p>Simulate on a 50*50 lattice to allow for more variation in spatial structure</p></li>
<li><p>Measurement of spatial structure:</p>
<p><strong>Step 1</strong>: Coarse-grain each patch into 1 of 3 states: total extinction (0), Sp1 dominant (1), Sp2 dominant (2)</p>
<p><span class="math display">\[
S(n_x) = \begin{cases} 0 &amp;\text{if $n_x = 0$}\\\\1 &amp;\text{if $n_1 &gt; n_2$}\\\\2 &amp;\text{if $n_2 &gt; n_1$}\end{cases}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Assortative-Dispersal-MS_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p><strong>Step 2</strong>: Calculate mutual information (I) between each patch and its nearest neighbor</p>
<p><span class="math display">\[
I(X;Y) = \sum_{X}\sum_{Y}P_{xy}\log(\frac{P_{xy}} {P_xP_y}) = H(X) + H(Y) - H(X,Y)
\]</span></p>
<p><strong>Step 3</strong>: Normalize mutual information (NMI)</p>
<p><span class="math display">\[
\text{NMI} =  \frac{I}{H(X)}
\]</span></p></li>
</ul>
<ol start="3" type="1">
<li><strong>Limiting similarity</strong> (MacArthur &amp; Levins 1967)
<ul>
<li><p>Select patches where both species co-occur (i.e.&nbsp;species don’t compete if they don’t co-occur)</p></li>
<li><p>Normalize densities of each species so that they sum to 1 across all co-occurring patches</p></li>
<li><p>Calculate niche overlap <span class="math inline">\(\alpha\)</span> using MacArthur &amp; Levins (1967) equation where <span class="math inline">\(U_{ix}\)</span> is the normalized density of species <span class="math inline">\(i\)</span> on patch <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[
\alpha = \frac{\sum_x U_{1x} U_{2x}} {\sum_x [U_{1x}]^2}
\]</span></p></li>
</ul></li>
<li>Stability
<ul>
<li><p>Coarse-grain each patch to 1 of 3 states like before</p></li>
<li><p>Calculate how many patches changed states between <span class="math inline">\(t\)</span> and <span class="math inline">\(t-1\)</span></p></li>
</ul></li>
</ol>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p><strong>Coexistence time</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="figs/N_phase.png" class="img-fluid" width="2700"></p>
</div>
</div>
<ul>
<li><p>Without any dispersal (d = 0) , extinction also reduces coexistence time. This is because as soon as a patch goes extinct, a patch cannot be re-seeded without dispersal, and thus, local extinction accumulates as time progresses until 1 or both species goes extinct regionally. This is shown by the origin (0,0) turning white when extinction &gt;0.</p></li>
<li><p>Focusing on the case where assortativity (<span class="math inline">\(\delta\)</span>) is 0 we can see that dispersal rate (d) decreases coexistence time when intespecific interactions (<span class="math inline">\(\alpha_{ij}\)</span>) is &gt;1. This is shown by the darker tiles becoming lighter as you move along the x-axis, away from the origin (d = 0).</p></li>
<li><p>The decrease in coexistence time by dispersal rate (d) however, can be compensated by dispersal asassortativity (<span class="math inline">\(\delta\)</span>). In other words, coexistence with higher dispersal rates require that dispersal be assortative. This is shown by the lighter tiles moving up the y-axis as dispersal rate increases.</p></li>
<li><p>Dispersal assortativity (<span class="math inline">\(\delta\)</span>) however is detrimental when disturbance is frequent (light region fanning out of y-axis as extinction % increases).</p></li>
<li><p>While dispersal assortativity ensures that each species secures its dominance in those regions through conspecific congregation (i.e., minimize exclusion by heterospecific competitors), by doing so, it forgoes opportunities to expand its range as new resources are replenished by disturbance events. As a result, high disturbance rates nullify the benefits of dispersal assortativity for regional coexistence.</p></li>
<li><p>Lastly, the intrinsic cost of assortative dispersal reduces coexistence at the high dispersal high assortativity regime. This is shown by the lighter tiles appearing out of the top-right corner of the panels as costs increase. This makes sense because as costs increase, the more migrants fail to make it to their destination. As a result, not only are populations exposing themselves to invasion by heterspecifics when they emigrate, they also fail to capitalize on the new patches due to strong viability selection.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="figs/W_phase.png" class="img-fluid" width="2700"></p>
</div>
</div>
<ul>
<li><p>Note: there might be a bug in this result</p></li>
<li><p>When dispersal is weighted by fitness as opposed to density, we see a drastically different outcome</p></li>
<li><p>In particular, coexistence becomes even more unlikely even when dispersal is assortative</p></li>
<li><p>Only regions with low dispersal rates can we see species coexisting for a longer time</p></li>
<li><p>One possible explanation for this is because the assessment of fitness of neighboring patches does not account for the fact that other individuals may also invade in the next time step. For example, if all individuals are dispersing to a patch that is empty (i.e., no competition), then the patch will be filled with new immigrants in the next time step such that competition is high.</p></li>
</ul>
<p><strong>Spatial structure</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/timeseries-test.gif" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/MI-s.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Lines correspond to the mutual information between local patch and its neighbors averaged over replicates</p></li>
<li><p>Since all simulations begin with equal densities there no spatial structure (NMI = 0)</p></li>
<li><p>As time unfolds NMI increases and patterns begin to form</p></li>
<li><p>In particular, NMI increases faster when dispersal is low. This makes sense because once a local patch dominates, more individuals will outflow to neighboring patches (uniformly) which increases the probability that those patches will also become dominated by the same species. I.e., dominance is locally contained</p></li>
<li><p>When dispersal is assortative, NMI increases much slower since each species is dispersing more <em>conservely</em>, enabling alternative stable states to become more local</p></li>
</ul>
<p><strong>MacArthur &amp; Levins limiting similarity</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/overlap-s.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>As a result of local exclusion and spatial pattern formation, each species effectively competes more with itself than heterospecifically, resulting in the minimization interpsecific competition and niche overlap</p></li>
<li><p>In our system, ranges and niches are near equivalent because regional densities are determined by how many patches each species occupy in addition to population size of each patch.</p></li>
<li><p>Because of priority effects, when one specie reaches its local carrying capacity, the growth rate of a heterospecific competitor if it were to invade is negative, which by definition, is outside its “niche”. Contrary (but not incompatible) to the conventional notion of the niche defined by external environment, the niche in this system is endogenously generated.</p></li>
</ul>
<p><strong>Stability</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/stab-s.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Overtime the spatial structure of the landscape reaches a steady-state where the patch transition probability is approximately equal to the extinction probability</p></li>
<li><p>In other words, patches only change state as the result of a disturbance event are less likely due to a turnover in species dominance</p></li>
</ul>
<p><strong>BONUS: Co-occurrence probability</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="figs/cooccur-s.png" class="img-fluid" width="350"></p>
</div>
</div>
<ul>
<li><p>Co-occurrence probability is simply the number of patches in which both species are present over the total number of patches in the system</p></li>
<li><p>In the simulation, we see that co-occurrence probability decreases overtime which is to be expected as each species locally exclude their interspecific competitor</p></li>
<li><p>However, co-occurrence probability reaches a steady-statae at a higher value when dispersal rates are low despite the fact that the landscape is more spatially autocorrelated (Fig 1).</p></li>
<li><p>This result may be because sink populations contain more individuals when dispersal assortativity is low. This would explain the hump-shaped pattern of co-occurrence probability since dispersing into a sink population decreases with both dispersal rate and assortativity.</p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>